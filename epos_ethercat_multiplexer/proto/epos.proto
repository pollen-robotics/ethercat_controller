syntax = "proto3";
package epos;

import "google/protobuf/empty.proto";
import "google/protobuf/wrappers.proto";

message EposIds {
    repeated int32 ids = 1;
}

message StateStreamRequest {
    repeated int32 ids = 1;
    float update_period = 2;
}

message EposState {
    int32 id = 1;

    bool compliant = 2;

    float actual_position = 3;
    float actual_velocity = 4;
    float actual_torque = 5;

    float requested_target_position = 6;
}

message EposStates {
    repeated EposState states = 1;
}

message EposCommand {
    int32 id = 1;

    google.protobuf.BoolValue compliancy = 2;
    google.protobuf.FloatValue target_position = 3;
}

message EposCommands {
    repeated EposCommand commands = 1;
}

service EposMultiplexer {
    rpc GetEposIds(google.protobuf.Empty) returns (EposIds);

    rpc GetStates (StateStreamRequest) returns (stream EposStates);
    rpc GetCommands (stream EposCommands) returns (google.protobuf.Empty);
}